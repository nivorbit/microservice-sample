{"stream_plugins":{"limit-conn":{"version":0.1,"priority":1003,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["conn","burst","default_conn_delay","key"],"properties":{"disable":{"type":"boolean"},"only_use_default_delay":{"default":false,"type":"boolean"},"key":{"type":"string"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"conn":{"exclusiveMinimum":0,"type":"integer"},"burst":{"minimum":0,"type":"integer"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"}},"type":"object"}},"mqtt-proxy":{"version":0.1,"priority":1000,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["protocol_name","protocol_level"],"properties":{"disable":{"type":"boolean"},"upstream":{"oneOf":[{"required":["host","port"]},{"required":["ip","port"]}],"properties":{"host":{"type":"string"},"port":{"type":"number"},"ip":{"type":"string"}},"description":"Deprecated. We should configure upstream outside of the plugin","type":"object"},"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"}},"type":"object"}},"ip-restriction":{"version":0.1,"priority":3000,"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}]}},"disable":{"type":"boolean"},"message":{"default":"Your IP address is not allowed","minLength":1,"maxLength":1024,"type":"string"},"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}]}}},"type":"object"}},"syslog":{"version":0.1,"priority":401,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"host":{"type":"string"},"timeout":{"type":"integer","default":3000,"minimum":1},"port":{"type":"integer"},"tls":{"default":false,"type":"boolean"},"flush_limit":{"type":"integer","default":4096,"minimum":1},"drop_limit":{"default":1048576,"type":"integer"},"sock_type":{"enum":["tcp","udp"],"default":"tcp","type":"string"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"name":{"default":"stream sys logger","type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"pool_size":{"type":"integer","default":5,"minimum":5},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}}},"main":{"proto":{"required":["content"],"properties":{"content":{"minLength":1,"maxLength":1048576,"type":"string"},"desc":{"maxLength":256,"type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"update_time":{"type":"integer"}},"type":"object"},"ssl":{"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}],"properties":{"client":{"required":["ca"],"properties":{"depth":{"type":"integer","default":1,"minimum":0},"ca":{"minLength":128,"maxLength":65536,"type":"string"}},"type":"object"},"update_time":{"type":"integer"},"validity_start":{"type":"integer"},"keys":{"items":{"minLength":128,"maxLength":65536,"type":"string"},"type":"array"},"create_time":{"type":"integer"},"validity_end":{"type":"integer"},"status":{"default":1,"enum":[1,0],"description":"ssl status, 1 to enable, 0 to disable","type":"integer"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"snis":{"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"cert":{"minLength":128,"maxLength":65536,"type":"string"},"certs":{"items":{"minLength":128,"maxLength":65536,"type":"string"},"type":"array"},"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"key":{"minLength":128,"maxLength":65536,"type":"string"},"exptime":{"minimum":1588262400,"type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]}},"type":"object"},"route":{"allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"properties":{"hosts":{"uniqueItems":true,"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"name":{"minLength":1,"maxLength":100,"type":"string"},"filter_func":{"pattern":"^function","minLength":10,"type":"string"},"script_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"properties":{"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars","type":"string"},"name":{"minLength":1,"maxLength":100,"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"tls":{"required":["client_cert","client_key"],"properties":{"client_cert":{"minLength":128,"maxLength":65536,"type":"string"},"client_key":{"minLength":128,"maxLength":65536,"type":"string"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"concurrency":{"default":10,"type":"integer"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"healthy":{"properties":{"http_statuses":{"default":[200,302],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"successes":{"default":2,"type":"integer","maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}},"type":"object"},"timeout":{"default":1,"type":"number"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"minItems":1,"type":"array"},"unhealthy":{"properties":{"timeouts":{"default":3,"type":"integer","maximum":254,"minimum":1},"http_statuses":{"default":[429,404,500,501,502,503,504,505],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"interval":{"type":"integer","default":1,"minimum":1},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":1},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":1}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"\/","type":"string"}},"type":"object"},"passive":{"default":{"unhealthy":{"timeouts":0,"http_statuses":[429,500,503],"http_failures":0,"tcp_failures":0},"healthy":{"successes":0,"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"type":"http"},"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[429,500,503],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":0},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":0}},"type":"object"},"healthy":{"properties":{"successes":{"default":5,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"}},"type":"object"}},"type":"object"},"keepalive_pool":{"properties":{"size":{"minimum":1,"default":320,"type":"integer"},"idle_timeout":{"minimum":0,"default":60,"type":"number"},"requests":{"minimum":1,"default":1000,"type":"integer"}},"type":"object"},"desc":{"maxLength":256,"type":"string"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":{"description":"algorithms of load balancing","type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"nodes":{"anyOf":[{"patternProperties":{".*":{"minimum":0,"description":"weight of node","type":"integer"}},"type":"object"},{"items":{"required":["host","port","weight"],"properties":{"weight":{"minimum":0,"description":"weight of node","type":"integer"},"port":{"minimum":1,"description":"port of node","type":"integer"},"metadata":{"description":"metadata of node","type":"object"},"priority":{"default":0,"description":"priority of node","type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"type":"object"},"type":"array"}]},"update_time":{"type":"integer"},"timeout":{"required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}},"type":"object"}},"type":"object"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"uri":{"minLength":1,"maxLength":4096,"type":"string"},"script":{"minLength":10,"maxLength":102400,"type":"string"},"priority":{"default":0,"type":"integer"},"status":{"default":1,"enum":[1,0],"description":"route status, 1 to enable, 0 to disable","type":"integer"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"desc":{"maxLength":256,"type":"string"},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service_protocol":{"enum":["grpc","http"]},"service_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"timeout":{"required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}},"type":"object"},"plugin_config_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"plugins":{"type":"object"},"remote_addr":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}],"description":"client IP","type":"string"},"update_time":{"type":"integer"},"remote_addrs":{"uniqueItems":true,"type":"array","minItems":1,"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}],"description":"client IP","type":"string"}},"uris":{"uniqueItems":true,"type":"array","minItems":1,"items":{"description":"HTTP uri","type":"string"}},"vars":{"type":"array"},"methods":{"uniqueItems":true,"type":"array","items":{"enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"description":"HTTP method","type":"string"}}},"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"type":"object"},"stream_route":{"properties":{"desc":{"maxLength":256,"type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"update_time":{"type":"integer"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"properties":{"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars","type":"string"},"name":{"minLength":1,"maxLength":100,"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"tls":{"required":["client_cert","client_key"],"properties":{"client_cert":{"minLength":128,"maxLength":65536,"type":"string"},"client_key":{"minLength":128,"maxLength":65536,"type":"string"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"concurrency":{"default":10,"type":"integer"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"healthy":{"properties":{"http_statuses":{"default":[200,302],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"successes":{"default":2,"type":"integer","maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}},"type":"object"},"timeout":{"default":1,"type":"number"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"minItems":1,"type":"array"},"unhealthy":{"properties":{"timeouts":{"default":3,"type":"integer","maximum":254,"minimum":1},"http_statuses":{"default":[429,404,500,501,502,503,504,505],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"interval":{"type":"integer","default":1,"minimum":1},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":1},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":1}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"\/","type":"string"}},"type":"object"},"passive":{"default":{"unhealthy":{"timeouts":0,"http_statuses":[429,500,503],"http_failures":0,"tcp_failures":0},"healthy":{"successes":0,"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"type":"http"},"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[429,500,503],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":0},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":0}},"type":"object"},"healthy":{"properties":{"successes":{"default":5,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"}},"type":"object"}},"type":"object"},"keepalive_pool":{"properties":{"size":{"minimum":1,"default":320,"type":"integer"},"idle_timeout":{"minimum":0,"default":60,"type":"number"},"requests":{"minimum":1,"default":1000,"type":"integer"}},"type":"object"},"desc":{"maxLength":256,"type":"string"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":{"description":"algorithms of load balancing","type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"nodes":{"anyOf":[{"patternProperties":{".*":{"minimum":0,"description":"weight of node","type":"integer"}},"type":"object"},{"items":{"required":["host","port","weight"],"properties":{"weight":{"minimum":0,"description":"weight of node","type":"integer"},"port":{"minimum":1,"description":"port of node","type":"integer"},"metadata":{"description":"metadata of node","type":"object"},"priority":{"default":0,"description":"priority of node","type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"type":"object"},"type":"array"}]},"update_time":{"type":"integer"},"timeout":{"required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}},"type":"object"}},"type":"object"},"server_addr":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}],"description":"server IP","type":"string"},"server_port":{"description":"server port","type":"integer"},"remote_addr":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}],"description":"client IP","type":"string"},"protocol":{"required":["name"],"properties":{"name":{"type":"string"},"superior_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"conf":{"description":"protocol-specific configuration","type":"object"},"logger":{"items":{"properties":{"name":{"type":"string"},"conf":{"description":"logger plugin configuration","type":"object"},"filter":{"description":"logger filter rules","type":"array"}},"dependencies":{"name":["conf"]}},"type":"array"}},"type":"object"},"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","description":"server name indication","type":"string"},"plugins":{"type":"object"},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"}},"type":"object"},"service":{"properties":{"hosts":{"uniqueItems":true,"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"name":{"minLength":1,"maxLength":100,"type":"string"},"desc":{"maxLength":256,"type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"properties":{"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars","type":"string"},"name":{"minLength":1,"maxLength":100,"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"tls":{"required":["client_cert","client_key"],"properties":{"client_cert":{"minLength":128,"maxLength":65536,"type":"string"},"client_key":{"minLength":128,"maxLength":65536,"type":"string"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"concurrency":{"default":10,"type":"integer"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"healthy":{"properties":{"http_statuses":{"default":[200,302],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"successes":{"default":2,"type":"integer","maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}},"type":"object"},"timeout":{"default":1,"type":"number"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"minItems":1,"type":"array"},"unhealthy":{"properties":{"timeouts":{"default":3,"type":"integer","maximum":254,"minimum":1},"http_statuses":{"default":[429,404,500,501,502,503,504,505],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"interval":{"type":"integer","default":1,"minimum":1},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":1},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":1}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"\/","type":"string"}},"type":"object"},"passive":{"default":{"unhealthy":{"timeouts":0,"http_statuses":[429,500,503],"http_failures":0,"tcp_failures":0},"healthy":{"successes":0,"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"type":"http"},"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[429,500,503],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":0},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":0}},"type":"object"},"healthy":{"properties":{"successes":{"default":5,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"}},"type":"object"}},"type":"object"},"keepalive_pool":{"properties":{"size":{"minimum":1,"default":320,"type":"integer"},"idle_timeout":{"minimum":0,"default":60,"type":"number"},"requests":{"minimum":1,"default":1000,"type":"integer"}},"type":"object"},"desc":{"maxLength":256,"type":"string"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":{"description":"algorithms of load balancing","type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"nodes":{"anyOf":[{"patternProperties":{".*":{"minimum":0,"description":"weight of node","type":"integer"}},"type":"object"},{"items":{"required":["host","port","weight"],"properties":{"weight":{"minimum":0,"description":"weight of node","type":"integer"},"port":{"minimum":1,"description":"port of node","type":"integer"},"metadata":{"description":"metadata of node","type":"object"},"priority":{"default":0,"description":"priority of node","type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"type":"object"},"type":"array"}]},"update_time":{"type":"integer"},"timeout":{"required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}},"type":"object"}},"type":"object"},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"plugins":{"type":"object"},"script":{"minLength":10,"maxLength":102400,"type":"string"},"update_time":{"type":"integer"},"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]}},"type":"object"},"upstream_hash_vars_schema":{"pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname)|arg_[0-9a-zA-z_-]+)$","type":"string"},"plugins":{"items":{"required":["name"],"properties":{"stream":{"type":"boolean"},"name":{"minLength":1,"type":"string"}},"type":"object"},"type":"array"},"plugin_config":{"required":["id","plugins"],"properties":{"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"desc":{"maxLength":256,"type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"plugins":{"type":"object"}},"type":"object"},"consumer":{"required":["username"],"properties":{"username":{"pattern":"^[a-zA-Z0-9_]+$","minLength":1,"maxLength":100,"type":"string"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"plugins":{"type":"object"},"create_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"update_time":{"type":"integer"}},"type":"object"},"upstream_hash_header_schema":{"pattern":"^[a-zA-Z0-9-_]+$","type":"string"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"properties":{"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars","type":"string"},"name":{"minLength":1,"maxLength":100,"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"tls":{"required":["client_cert","client_key"],"properties":{"client_cert":{"minLength":128,"maxLength":65536,"type":"string"},"client_key":{"minLength":128,"maxLength":65536,"type":"string"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"concurrency":{"default":10,"type":"integer"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"healthy":{"properties":{"http_statuses":{"default":[200,302],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"successes":{"default":2,"type":"integer","maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}},"type":"object"},"timeout":{"default":1,"type":"number"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"minItems":1,"type":"array"},"unhealthy":{"properties":{"timeouts":{"default":3,"type":"integer","maximum":254,"minimum":1},"http_statuses":{"default":[429,404,500,501,502,503,504,505],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"interval":{"type":"integer","default":1,"minimum":1},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":1},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":1}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"\/","type":"string"}},"type":"object"},"passive":{"default":{"unhealthy":{"timeouts":0,"http_statuses":[429,500,503],"http_failures":0,"tcp_failures":0},"healthy":{"successes":0,"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"type":"http"},"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[429,500,503],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":0},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":0}},"type":"object"},"healthy":{"properties":{"successes":{"default":5,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"}},"type":"object"}},"type":"object"},"keepalive_pool":{"properties":{"size":{"minimum":1,"default":320,"type":"integer"},"idle_timeout":{"minimum":0,"default":60,"type":"number"},"requests":{"minimum":1,"default":1000,"type":"integer"}},"type":"object"},"desc":{"maxLength":256,"type":"string"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":{"description":"algorithms of load balancing","type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"nodes":{"anyOf":[{"patternProperties":{".*":{"minimum":0,"description":"weight of node","type":"integer"}},"type":"object"},{"items":{"required":["host","port","weight"],"properties":{"weight":{"minimum":0,"description":"weight of node","type":"integer"},"port":{"minimum":1,"description":"port of node","type":"integer"},"metadata":{"description":"metadata of node","type":"object"},"priority":{"default":0,"description":"priority of node","type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"type":"object"},"type":"array"}]},"update_time":{"type":"integer"},"timeout":{"required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}},"type":"object"}},"type":"object"},"global_rule":{"required":["plugins"],"properties":{"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"create_time":{"type":"integer"},"plugins":{"type":"object"},"update_time":{"type":"integer"}},"type":"object"}},"plugins":{"api-breaker":{"version":0.1,"priority":1005,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["break_response_code"],"properties":{"disable":{"type":"boolean"},"healthy":{"default":{"successes":3,"http_statuses":[200]},"properties":{"successes":{"type":"integer","default":3,"minimum":1},"http_statuses":{"default":[200],"type":"array","items":{"type":"integer","maximum":499,"minimum":200},"minItems":1,"uniqueItems":true}},"type":"object"},"unhealthy":{"default":{"failures":3,"http_statuses":[500]},"properties":{"failures":{"type":"integer","default":3,"minimum":1},"http_statuses":{"default":[500],"type":"array","items":{"type":"integer","maximum":599,"minimum":500},"minItems":1,"uniqueItems":true}},"type":"object"},"break_response_code":{"type":"integer","maximum":599,"minimum":200},"break_response_body":{"type":"string"},"break_response_headers":{"items":{"properties":{"value":{"minLength":1,"type":"string"},"key":{"minLength":1,"type":"string"}},"type":"object"},"type":"array"},"max_breaker_sec":{"type":"integer","default":300,"minimum":3}},"type":"object"}},"prometheus":{"priority":500,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"prefer_name":{"default":false,"type":"boolean"},"disable":{"type":"boolean"}},"type":"object"},"version":0.2},"skywalking-logger":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["endpoint_addr"],"properties":{"name":{"default":"skywalking logger","type":"string"},"endpoint_addr":{"pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"disable":{"type":"boolean"},"service_name":{"default":"APISIX","type":"string"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"timeout":{"type":"integer","default":3,"minimum":1},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"service_instance_name":{"default":"APISIX Instance Name","type":"string"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"},"priority":408,"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}},"request-id":{"priority":11010,"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"algorithm":{"enum":["uuid","snowflake","nanoid"],"default":"uuid","type":"string"},"include_in_response":{"default":true,"type":"boolean"},"header_name":{"default":"X-Request-Id","type":"string"},"disable":{"type":"boolean"}},"type":"object"}},"kafka-logger":{"version":0.1,"priority":403,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["broker_list","kafka_topic"],"properties":{"include_req_body_expr":{"items":{"type":"array"},"minItems":1,"type":"array"},"meta_format":{"enum":["default","origin"],"default":"default","type":"string"},"include_resp_body_expr":{"items":{"type":"array"},"minItems":1,"type":"array"},"broker_list":{"minProperties":1,"patternProperties":{".*":{"maximum":65535,"minimum":1,"description":"the port of kafka broker","type":"integer"}},"type":"object"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"required_acks":{"enum":[0,1,-1],"default":1,"type":"integer"},"cluster_name":{"type":"integer","default":1,"minimum":1},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"timeout":{"type":"integer","default":3,"minimum":1},"disable":{"type":"boolean"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"name":{"default":"kafka logger","type":"string"},"key":{"type":"string"},"producer_type":{"enum":["async","sync"],"default":"async","type":"string"},"kafka_topic":{"type":"string"},"include_resp_body":{"default":false,"type":"boolean"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"},"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}},"wolf-rbac":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"header_prefix":{"default":"X-","type":"string"},"server":{"default":"http:\/\/127.0.0.1:12180","type":"string"},"appid":{"default":"unset","type":"string"},"disable":{"type":"boolean"}},"type":"object"},"priority":2555,"version":0.1,"type":"auth"},"request-validation":{"schema":{"anyOf":[{"required":["header_schema"]},{"required":["body_schema"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"header_schema":{"type":"object"},"body_schema":{"type":"object"},"rejected_code":{"default":400,"type":"integer","maximum":599,"minimum":200},"rejected_msg":{"minLength":1,"maxLength":256,"type":"string"},"disable":{"type":"boolean"}},"type":"object"},"priority":2800,"version":0.1,"type":"validation"},"proxy-control":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"request_buffering":{"default":true,"type":"boolean"}},"type":"object"},"priority":21990,"version":0.1},"real-ip":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["source"],"properties":{"trusted_addresses":{"type":"array","minItems":1,"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}]}},"recursive":{"default":false,"type":"boolean"},"source":{"minLength":1,"type":"string"},"disable":{"type":"boolean"}},"type":"object"},"priority":23000,"version":0.1},"referer-restriction":{"version":0.1,"priority":2990,"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"bypass_missing":{"default":false,"type":"boolean"},"whitelist":{"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"blacklist":{"type":"array","minItems":1,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"message":{"default":"Your referer host is not allowed","minLength":1,"maxLength":1024,"type":"string"},"disable":{"type":"boolean"}},"type":"object"}},"datadog":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"name":{"default":"datadog","type":"string"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"prefer_name":{"default":true,"type":"boolean"},"disable":{"type":"boolean"}},"type":"object"},"priority":495,"metadata_schema":{"properties":{"namespace":{"default":"apisix","type":"string"},"host":{"default":"127.0.0.1","type":"string"},"constant_tags":{"type":"array","default":["source:apisix"],"items":{"type":"string"}},"port":{"type":"integer","default":8125,"minimum":0}},"type":"object"}},"sls-logger":{"version":0.1,"priority":406,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host","port","project","logstore","access_key_id","access_key_secret"],"properties":{"host":{"type":"string"},"disable":{"type":"boolean"},"port":{"type":"integer"},"project":{"type":"string"},"logstore":{"type":"string"},"access_key_id":{"type":"string"},"access_key_secret":{"type":"string"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"timeout":{"type":"integer","default":5000,"minimum":1},"name":{"default":"sls-logger","type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"}},"grpc-web":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"type":"object"},"priority":505},"cors":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"allow_credential":{"default":false,"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","type":"boolean"},"allow_origins":{"pattern":"^(\\*|\\*\\*|null|\\w+:\/\/[^,]+(,\\w+:\/\/[^,]+)*)$","default":"*","description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","type":"string"},"max_age":{"default":5,"description":"maximum number of seconds the results can be cached.-1 means no cached, the max value is depend on browser,more details plz check MDN. default: 5.","type":"integer"},"allow_methods":{"default":"*","description":"you can use '*' to allow all methods when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","type":"string"},"allow_headers":{"default":"*","description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","type":"string"},"allow_origins_by_regex":{"uniqueItems":true,"type":"array","description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com] to allow a.test.com and b.test.com","minItems":1,"items":{"minLength":1,"maxLength":4096,"type":"string"}},"expose_headers":{"default":"*","description":"you can use '*' to expose all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","type":"string"},"allow_origins_by_metadata":{"uniqueItems":true,"type":"array","description":"set allowed origins by referencing origins in plugin metadata","minItems":1,"items":{"minLength":1,"maxLength":4096,"type":"string"}},"disable":{"type":"boolean"}},"type":"object"},"priority":4000,"version":0.1,"metadata_schema":{"properties":{"allow_origins":{"additionalProperties":{"pattern":"^(\\*|\\*\\*|null|\\w+:\/\/[^,]+(,\\w+:\/\/[^,]+)*)$","type":"string"},"type":"object"}},"type":"object"}},"clickhouse-logger":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["endpoint_addr","user","password","database","logtable"],"properties":{"name":{"default":"clickhouse-logger","type":"string"},"ssl_verify":{"default":true,"type":"boolean"},"endpoint_addr":{"pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"timeout":{"type":"integer","default":3,"minimum":1},"password":{"default":"","type":"string"},"user":{"default":"","type":"string"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"database":{"default":"","type":"string"},"logtable":{"default":"","type":"string"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"priority":398,"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}},"opa":{"version":0.1,"priority":2001,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host","policy"],"properties":{"keepalive_pool":{"type":"integer","default":5,"minimum":1},"host":{"type":"string"},"policy":{"type":"string"},"with_route":{"default":false,"type":"boolean"},"with_service":{"default":false,"type":"boolean"},"timeout":{"description":"timeout in milliseconds","minimum":1,"maximum":60000,"default":3000,"type":"integer"},"disable":{"type":"boolean"},"with_consumer":{"default":false,"type":"boolean"},"ssl_verify":{"default":true,"type":"boolean"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"keepalive":{"default":true,"type":"boolean"}},"type":"object"}},"limit-req":{"version":0.1,"priority":1001,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["rate","burst","key"],"properties":{"nodelay":{"default":false,"type":"boolean"},"allow_degradation":{"default":false,"type":"boolean"},"disable":{"type":"boolean"},"rate":{"exclusiveMinimum":0,"type":"number"},"key":{"type":"string"},"rejected_code":{"default":503,"type":"integer","maximum":599,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"burst":{"minimum":0,"type":"number"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"}},"type":"object"}},"proxy-rewrite":{"schema":{"minProperties":1,"$comment":"this is a mark for our injected plugin schema","properties":{"method":{"enum":["LOCK","UNLOCK","PATCH","TRACE","GET","HEAD","POST","PUT","DELETE","MKCOL","COPY","MOVE","OPTIONS","PROPFIND"],"description":"proxy route method","type":"string"},"host":{"pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$","description":"new host for upstream","type":"string"},"uri":{"minLength":1,"maxLength":4096,"pattern":"^\\\/.*","description":"new uri for upstream","type":"string"},"regex_uri":{"items":{"description":"regex uri","type":"string"},"maxItems":2,"description":"new uri that substitute from client uri for upstream, lower priority than uri property","minItems":2,"type":"array"},"scheme":{"enum":["http","https"],"description":"new scheme for upstream","type":"string"},"headers":{"minProperties":1,"description":"new headers for request","type":"object"},"disable":{"type":"boolean"}},"type":"object"},"priority":1008,"version":0.1},"gzip":{"version":0.1,"priority":995,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"buffers":{"default":{"number":32,"size":4096},"properties":{"number":{"type":"integer","default":32,"minimum":1},"size":{"type":"integer","default":4096,"minimum":1}},"type":"object"},"min_length":{"type":"integer","default":20,"minimum":1},"comp_level":{"default":1,"type":"integer","maximum":9,"minimum":1},"http_version":{"default":1.1,"enum":[1.1,1]},"types":{"default":["text\/html"],"anyOf":[{"items":{"minLength":1,"type":"string"},"minItems":1,"type":"array"},{"enum":["*"]}]},"vary":{"type":"boolean"}},"type":"object"}},"nivorbit-openid-connect":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["client_id","client_secret","discovery","token_exchange","token_endpoint","audience"],"properties":{"post_logout_redirect_uri":{"description":"the URI will be redirect when request logout_path","type":"string"},"public_key":{"type":"string"},"token_signing_alg_values_expected":{"type":"string"},"set_access_token_header":{"default":true,"description":"Whether the access token should be added as a header to the request for downstream","type":"boolean"},"access_token_in_authorization_header":{"default":false,"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","type":"boolean"},"set_refresh_token_header":{"default":false,"description":"Whether the refresh token should be added in the X-Refresh-Token header to the request for downstream.","type":"boolean"},"set_id_token_header":{"default":true,"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","type":"boolean"},"discovery":{"type":"string"},"client_id":{"type":"string"},"set_userinfo_header":{"default":true,"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","type":"boolean"},"token_endpoint":{"description":"Token endpoint","type":"string"},"ssl_verify":{"default":false,"type":"boolean"},"disable":{"type":"boolean"},"audience":{"default":"","type":"string"},"client_secret":{"type":"string"},"timeout":{"description":"timeout in seconds","type":"integer","default":3,"minimum":1},"introspection_endpoint":{"type":"string"},"introspection_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"token_exchange":{"default":false,"description":"Whether the token exchange enable. It will change current token with a new one","type":"boolean"},"bearer_only":{"default":false,"type":"boolean"},"realm":{"default":"apisix","type":"string"},"logout_path":{"default":"\/logout","type":"string"},"scope":{"default":"openid","type":"string"},"redirect_uri":{"description":"use ngx.var.request_uri if not configured","type":"string"}},"type":"object"},"priority":2699,"version":0.1},"azure-functions":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["function_uri"],"properties":{"keepalive_pool":{"type":"integer","default":5,"minimum":1},"disable":{"type":"boolean"},"authorization":{"properties":{"clientid":{"type":"string"},"apikey":{"type":"string"}},"type":"object"},"ssl_verify":{"default":true,"type":"boolean"},"keepalive":{"default":true,"type":"boolean"},"function_uri":{"type":"string"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"timeout":{"type":"integer","default":3000,"minimum":100}},"type":"object"},"priority":-1900,"metadata_schema":{"properties":{"master_clientid":{"default":"","type":"string"},"master_apikey":{"default":"","type":"string"}},"type":"object"}},"csrf":{"version":0.1,"priority":2980,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["key"],"properties":{"name":{"default":"apisix-csrf-token","description":"the csrf token name","type":"string"},"key":{"description":"use to generate csrf token","type":"string"},"expires":{"default":7200,"description":"expires time(s) for csrf token","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}},"proxy-mirror":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host"],"properties":{"sample_ratio":{"default":1,"type":"number","maximum":1,"minimum":1e-05},"host":{"pattern":"^http(s)?:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?$","type":"string"},"disable":{"type":"boolean"},"path":{"pattern":"^\/[^?&]+$","type":"string"}},"type":"object"},"priority":1010,"version":0.1},"hmac-auth":{"version":0.1,"consumer_schema":{"properties":{"signed_headers":{"items":{"minLength":1,"maxLength":50,"type":"string"},"type":"array"},"keep_headers":{"default":false,"title":"whether to keep the http request header","type":"boolean"},"encode_uri_params":{"default":true,"title":"Whether to escape the uri parameter","type":"boolean"},"validate_request_body":{"default":false,"title":"A boolean value telling the plugin to enable body validation","type":"boolean"},"max_req_body":{"default":524288,"title":"Max request body size","type":"integer"},"access_key":{"minLength":1,"maxLength":256,"type":"string"},"secret_key":{"minLength":1,"maxLength":256,"type":"string"},"algorithm":{"enum":["hmac-sha1","hmac-sha256","hmac-sha512"],"default":"hmac-sha256","type":"string"},"clock_skew":{"default":0,"type":"integer"}},"required":["access_key","secret_key"],"title":"work with consumer object","type":"object"},"schema":{"properties":{"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","title":"work with route or service object","type":"object"},"priority":2530,"type":"auth"},"jwt-auth":{"version":0.1,"consumer_schema":{"required":["key"],"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"default":"HS256","enum":["HS256","HS512"]}}},{"properties":{"private_key":{"type":"string"},"algorithm":{"enum":["RS256"]},"public_key":{"type":"string"}},"required":["public_key","private_key"]},{"properties":{"algorithm":{"enum":["RS256"]},"vault":{"properties":{},"type":"object"}},"required":["vault"]}]}},"properties":{"exp":{"type":"integer","default":86400,"minimum":1},"vault":{"properties":{},"type":"object"},"base64_secret":{"default":false,"type":"boolean"},"key":{"type":"string"},"algorithm":{"enum":["HS256","HS512","RS256"],"default":"HS256","type":"string"},"secret":{"type":"string"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"query":{"default":"jwt","type":"string"},"header":{"default":"authorization","type":"string"},"cookie":{"default":"jwt","type":"string"},"disable":{"type":"boolean"}},"type":"object"},"priority":2510,"type":"auth"},"openid-connect":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["client_id","client_secret","discovery"],"properties":{"post_logout_redirect_uri":{"description":"the URI will be redirect when request logout_path","type":"string"},"public_key":{"type":"string"},"token_signing_alg_values_expected":{"type":"string"},"set_access_token_header":{"default":true,"description":"Whether the access token should be added as a header to the request for downstream","type":"boolean"},"access_token_in_authorization_header":{"default":false,"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","type":"boolean"},"set_id_token_header":{"default":true,"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","type":"boolean"},"discovery":{"type":"string"},"client_id":{"type":"string"},"set_userinfo_header":{"default":true,"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","type":"boolean"},"ssl_verify":{"default":false,"type":"boolean"},"client_secret":{"type":"string"},"timeout":{"description":"timeout in seconds","type":"integer","default":3,"minimum":1},"introspection_endpoint":{"type":"string"},"introspection_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"disable":{"type":"boolean"},"bearer_only":{"default":false,"type":"boolean"},"realm":{"default":"apisix","type":"string"},"logout_path":{"default":"\/logout","type":"string"},"scope":{"default":"openid","type":"string"},"redirect_uri":{"description":"use ngx.var.request_uri if not configured","type":"string"}},"type":"object"},"priority":2599,"version":0.1},"zipkin":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["endpoint","sample_ratio"],"properties":{"sample_ratio":{"type":"number","maximum":1,"minimum":1e-05},"disable":{"type":"boolean"},"span_version":{"default":2,"enum":[1,2]},"service_name":{"default":"APISIX","description":"service name for zipkin reporter","type":"string"},"endpoint":{"type":"string"},"server_addr":{"pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$","description":"default is $server_addr, you can specify your external ip address","type":"string"}},"type":"object"},"version":0.1,"priority":12011},"file-logger":{"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["path"],"properties":{"disable":{"type":"boolean"},"path":{"type":"string"}},"type":"object"},"priority":399,"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}},"splunk-hec-logging":{"version":0.1,"priority":409,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["endpoint"],"properties":{"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"ssl_verify":{"default":true,"type":"boolean"},"endpoint":{"required":["uri","token"],"properties":{"timeout":{"type":"integer","default":10,"minimum":1},"token":{"type":"string"},"uri":{"pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"channel":{"type":"string"}},"type":"object"},"name":{"default":"splunk-hec-logging","type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"disable":{"type":"boolean"}},"type":"object"}},"ldap-auth":{"version":0.1,"consumer_schema":{"properties":{"user_dn":{"type":"string"}},"required":["user_dn"],"title":"work with consumer object","type":"object"},"schema":{"properties":{"base_dn":{"type":"string"},"ldap_uri":{"type":"string"},"use_tls":{"type":"boolean"},"uid":{"type":"string"},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","required":["base_dn","ldap_uri"],"title":"work with route or service object","type":"object"},"priority":2540,"type":"auth"},"authz-keycloak":{"version":0.1,"priority":2000,"schema":{"allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"required":["client_id"]},{"required":["audience"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"properties":{"lazy_load_paths":{"enum":[true]}},"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}]}]}],"$comment":"this is a mark for our injected plugin schema","properties":{"cache_ttl_seconds":{"type":"integer","default":86400,"minimum":1},"resource_registration_endpoint":{"minLength":1,"maxLength":4096,"type":"string"},"keepalive_pool":{"type":"integer","default":5,"minimum":1},"refresh_token_expires_in":{"type":"integer","default":3600,"minimum":1},"discovery":{"minLength":1,"maxLength":4096,"type":"string"},"client_id":{"minLength":1,"maxLength":100,"type":"string"},"audience":{"description":"Deprecated, use `client_id` instead.","minLength":1,"maxLength":100,"type":"string"},"keepalive":{"default":true,"type":"boolean"},"token_endpoint":{"minLength":1,"maxLength":4096,"type":"string"},"policy_enforcement_mode":{"enum":["ENFORCING","PERMISSIVE"],"default":"ENFORCING","type":"string"},"access_token_expires_in":{"type":"integer","default":300,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"permissions":{"type":"array","uniqueItems":true,"default":{},"items":{"minLength":1,"maxLength":100,"type":"string"}},"lazy_load_paths":{"default":false,"type":"boolean"},"client_secret":{"minLength":1,"maxLength":100,"type":"string"},"timeout":{"type":"integer","default":3000,"minimum":1000},"access_denied_redirect_uri":{"minLength":1,"maxLength":2048,"type":"string"},"access_token_expires_leeway":{"type":"integer","default":0,"minimum":0},"refresh_token_expires_leeway":{"type":"integer","default":0,"minimum":0},"password_grant_token_generation_incoming_uri":{"minLength":1,"maxLength":4096,"type":"string"},"grant_type":{"minLength":1,"maxLength":100,"enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"default":"urn:ietf:params:oauth:grant-type:uma-ticket","type":"string"},"http_method_as_scope":{"default":false,"type":"boolean"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"disable":{"type":"boolean"}},"type":"object"}},"rocketmq-logger":{"version":0.1,"priority":402,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["nameserver_list","topic"],"properties":{"name":{"default":"rocketmq logger","type":"string"},"meta_format":{"enum":["default","origin"],"default":"default","type":"string"},"include_resp_body_expr":{"items":{"type":"array"},"minItems":1,"type":"array"},"access_key":{"default":"","type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"key":{"type":"string"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"topic":{"type":"string"},"nameserver_list":{"items":{"type":"string"},"minItems":1,"type":"array"},"tag":{"type":"string"},"use_tls":{"default":false,"type":"boolean"},"timeout":{"type":"integer","default":3,"minimum":1},"disable":{"type":"boolean"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"secret_key":{"default":"","type":"string"},"include_req_body_expr":{"items":{"type":"array"},"minItems":1,"type":"array"},"include_resp_body":{"default":false,"type":"boolean"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"},"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}},"fault-injection":{"schema":{"minProperties":1,"$comment":"this is a mark for our injected plugin schema","properties":{"delay":{"required":["duration"],"properties":{"percentage":{"type":"integer","maximum":100,"minimum":0},"vars":{"items":{"type":"array"},"maxItems":20,"type":"array"},"duration":{"minimum":0,"type":"number"}},"type":"object"},"disable":{"type":"boolean"},"abort":{"required":["http_status"],"properties":{"http_status":{"minimum":200,"type":"integer"},"vars":{"items":{"type":"array"},"maxItems":20,"type":"array"},"percentage":{"type":"integer","maximum":100,"minimum":0},"body":{"minLength":0,"type":"string"}},"type":"object"}},"type":"object"},"priority":11000,"version":0.1},"consumer-restriction":{"version":0.1,"priority":2400,"schema":{"anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"rejected_msg":{"type":"string"},"whitelist":{"items":{"type":"string"},"minItems":1,"type":"array"},"blacklist":{"items":{"type":"string"},"minItems":1,"type":"array"},"allowed_by_methods":{"items":{"properties":{"methods":{"items":{"enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"description":"HTTP method","type":"string"},"minItems":1,"type":"array"},"user":{"type":"string"}},"type":"object"},"type":"array"},"rejected_code":{"type":"integer","default":403,"minimum":200},"type":{"enum":["consumer_name","service_id","route_id"],"default":"consumer_name","type":"string"}},"type":"object"}},"openwhisk":{"version":0.1,"priority":-1901,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["api_host","service_token","namespace","action"],"properties":{"keepalive_pool":{"type":"integer","default":5,"minimum":1},"namespace":{"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","maxLength":256,"type":"string"},"ssl_verify":{"default":true,"type":"boolean"},"action":{"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","maxLength":256,"type":"string"},"result":{"default":true,"type":"boolean"},"timeout":{"description":"timeout in milliseconds","minimum":1,"maximum":60000,"default":3000,"type":"integer"},"api_host":{"type":"string"},"service_token":{"type":"string"},"disable":{"type":"boolean"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"package":{"pattern":"\\A([\\w]|[\\w][\\w@ .-]*[\\w@.-]+)\\z","maxLength":256,"type":"string"},"keepalive":{"default":true,"type":"boolean"}},"type":"object"}},"response-rewrite":{"version":0.1,"priority":899,"schema":{"minProperties":1,"$comment":"this is a mark for our injected plugin schema","properties":{"body":{"description":"new body for response","type":"string"},"vars":{"type":"array"},"filters":{"items":{"properties":{"regex":{"minLength":1,"description":"match pattern on response body","type":"string"},"scope":{"default":"once","enum":["once","global"],"description":"regex substitution range","type":"string"},"replace":{"description":"regex substitution content","type":"string"},"options":{"default":"jo","description":"regex options","type":"string"}},"required":["regex","replace"],"description":"filter that modifies response body","type":"object"},"minItems":1,"description":"a group of filters that modify response bodyby replacing one specified string by another","type":"array"},"headers":{"minProperties":1,"description":"new headers for response","type":"object"},"oneOf":["body","filters"],"body_base64":{"default":false,"description":"whether new body for response need base64 decode before return","type":"boolean"},"status_code":{"maximum":598,"minimum":200,"description":"new status code for response","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}},"traffic-split":{"version":0.1,"priority":966,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"rules":{"items":{"properties":{"weighted_upstreams":{"maxItems":20,"items":{"properties":{"upstream_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"weight":{"minimum":0,"default":1,"description":"used to split traffic between differentupstreams for plugin configuration","type":"integer"},"upstream":{"oneOf":[{"required":["type","nodes"]},{"required":["type","service_name","discovery_type"]}],"properties":{"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"default":"vars","type":"string"},"name":{"minLength":1,"maxLength":100,"type":"string"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"default":"http","description":"The scheme of the upstream. For L7 proxy, it can be one of grpc\/grpcs\/http\/https. For L4 proxy, it can be one of tcp\/tls\/udp. For specific protocols, it can be kafka."},"tls":{"required":["client_cert","client_key"],"properties":{"client_cert":{"minLength":128,"maxLength":65536,"type":"string"},"client_key":{"minLength":128,"maxLength":65536,"type":"string"}},"type":"object"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"labels":{"patternProperties":{".*":{"minLength":1,"maxLength":64,"pattern":"^\\S+$","description":"value of label","type":"string"}},"description":"key\/value pairs to specify attributes","type":"object"},"discovery_type":{"description":"discovery type","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"properties":{"active":{"properties":{"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"concurrency":{"default":10,"type":"integer"},"port":{"type":"integer","maximum":65535,"minimum":1},"https_verify_certificate":{"default":true,"type":"boolean"},"healthy":{"properties":{"http_statuses":{"default":[200,302],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"successes":{"default":2,"type":"integer","maximum":254,"minimum":1},"interval":{"type":"integer","default":1,"minimum":1}},"type":"object"},"timeout":{"default":1,"type":"number"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"minItems":1,"type":"array"},"unhealthy":{"properties":{"timeouts":{"default":3,"type":"integer","maximum":254,"minimum":1},"http_statuses":{"default":[429,404,500,501,502,503,504,505],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"interval":{"type":"integer","default":1,"minimum":1},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":1},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":1}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"http_path":{"default":"\/","type":"string"}},"type":"object"},"passive":{"default":{"unhealthy":{"timeouts":0,"http_statuses":[429,500,503],"http_failures":0,"tcp_failures":0},"healthy":{"successes":0,"http_statuses":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308]},"type":"http"},"properties":{"unhealthy":{"properties":{"timeouts":{"default":7,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[429,500,503],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true},"http_failures":{"default":5,"type":"integer","maximum":254,"minimum":0},"tcp_failures":{"default":2,"type":"integer","maximum":254,"minimum":0}},"type":"object"},"healthy":{"properties":{"successes":{"default":5,"type":"integer","maximum":254,"minimum":0},"http_statuses":{"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","items":{"type":"integer","maximum":599,"minimum":200},"minItems":1,"uniqueItems":true}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"}},"type":"object"}},"type":"object"},"keepalive_pool":{"properties":{"size":{"minimum":1,"default":320,"type":"integer"},"idle_timeout":{"minimum":0,"default":60,"type":"number"},"requests":{"minimum":1,"default":1000,"type":"integer"}},"type":"object"},"desc":{"maxLength":256,"type":"string"},"pass_host":{"default":"pass","enum":["pass","node","rewrite"],"description":"mod of host passing","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"type":{"description":"algorithms of load balancing","type":"string"},"id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service_name":{"minLength":1,"maxLength":256,"type":"string"},"nodes":{"anyOf":[{"patternProperties":{".*":{"minimum":0,"description":"weight of node","type":"integer"}},"type":"object"},{"items":{"required":["host","port","weight"],"properties":{"weight":{"minimum":0,"description":"weight of node","type":"integer"},"port":{"minimum":1,"description":"port of node","type":"integer"},"metadata":{"description":"metadata of node","type":"object"},"priority":{"default":0,"description":"priority of node","type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"}},"type":"object"},"type":"array"}]},"update_time":{"type":"integer"},"timeout":{"required":["connect","send","read"],"properties":{"send":{"exclusiveMinimum":0,"type":"number"},"connect":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}},"type":"object"}},"type":"object"}},"type":"object"},"default":[{"weight":1}],"minItems":1,"type":"array"},"match":{"items":{"properties":{"vars":{"type":"array"}},"type":"object"},"type":"array"}},"type":"object"},"type":"array"}},"type":"object"}},"authz-casdoor":{"version":0.1,"priority":2559,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["callback_url","endpoint_addr","client_id","client_secret"],"properties":{"callback_url":{"pattern":"^[^%?]+[^\/]$","type":"string"},"endpoint_addr":{"pattern":"^[^%?]+[^\/]$","type":"string"},"client_id":{"type":"string"},"client_secret":{"type":"string"},"disable":{"type":"boolean"}},"type":"object"}},"redirect":{"schema":{"oneOf":[{"required":["uri"]},{"required":["regex_uri"]},{"required":["http_to_https"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"},"http_to_https":{"type":"boolean"},"regex_uri":{"items":{"description":"regex uri","type":"string"},"maxItems":2,"description":"params for generating new uri that substitute from client uri, first param is regular expression, the second one is uri template","minItems":2,"type":"array"},"append_query_string":{"default":false,"type":"boolean"},"encode_uri":{"default":false,"type":"boolean"},"uri":{"pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)","minLength":2,"type":"string"},"ret_code":{"type":"integer","default":302,"minimum":200}},"type":"object"},"priority":900,"version":0.1},"ext-plugin-pre-req":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"conf":{"type":"array","minItems":1,"items":{"required":["name","value"],"properties":{"value":{"type":"string"},"name":{"minLength":1,"maxLength":128,"type":"string"}},"type":"object"}},"allow_degradation":{"default":false,"type":"boolean"},"disable":{"type":"boolean"}},"type":"object"},"priority":12000,"version":0.1},"tcp-logger":{"version":0.1,"priority":405,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"host":{"type":"string"},"port":{"minimum":0,"type":"integer"},"tls":{"default":false,"type":"boolean"},"disable":{"type":"boolean"},"timeout":{"type":"integer","default":1000,"minimum":1},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"name":{"default":"tcp logger","type":"string"},"tls_options":{"type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"}},"example-plugin":{"priority":0,"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["i"],"properties":{"i":{"minimum":0,"type":"number"},"ip":{"type":"string"},"s":{"type":"string"},"t":{"minItems":1,"type":"array"},"port":{"type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"metadata_schema":{"required":["ikey","skey"],"properties":{"skey":{"type":"string"},"ikey":{"minimum":0,"type":"number"}},"type":"object"}},"ext-plugin-post-resp":{"version":0.1,"priority":-4000,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"conf":{"type":"array","minItems":1,"items":{"required":["name","value"],"properties":{"value":{"type":"string"},"name":{"minLength":1,"maxLength":128,"type":"string"}},"type":"object"}},"allow_degradation":{"default":false,"type":"boolean"},"disable":{"type":"boolean"}},"type":"object"}},"public-api":{"version":0.1,"priority":501,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"uri":{"type":"string"},"disable":{"type":"boolean"}},"type":"object"}},"server-info":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"disable":{"type":"boolean"}},"type":"object"},"scope":"global","version":0.1,"priority":990},"mocking":{"version":0.1,"priority":10900,"schema":{"anyOf":[{"required":["response_example"]},{"required":["response_schema"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"response_example":{"type":"string"},"delay":{"default":0,"type":"integer"},"with_mock_header":{"default":true,"type":"boolean"},"content_type":{"default":"application\/json;charset=utf8","type":"string"},"response_schema":{"type":"object"},"response_status":{"minimum":100,"default":200,"type":"integer"},"disable":{"type":"boolean"}},"type":"object"}},"udp-logger":{"version":0.1,"priority":400,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"name":{"default":"udp logger","type":"string"},"port":{"minimum":0,"type":"integer"},"timeout":{"type":"integer","default":3,"minimum":1},"disable":{"type":"boolean"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"host":{"type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"}},"loggly":{"version":0.1,"priority":411,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["customer_token"],"properties":{"name":{"default":"loggly","type":"string"},"severity_map":{"additionalProperties":false,"patternProperties":{"^[1-5][0-9]{2}$":{"enum":["ALERT","alert","CRIT","crit","ERR","err","DEBUG","debug","NOTICE","notice","INFO","info","EMEGR","emegr","WARNING","warning"],"description":"keys are HTTP status code, values are severity","type":"string"}},"description":"upstream response code vs syslog severity mapping","type":"object"},"ssl_verify":{"default":true,"type":"boolean"},"disable":{"type":"boolean"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"tags":{"default":["apisix"],"items":{"pattern":"^(?!tag=)[ -~]*","type":"string"},"minItems":1,"type":"array"},"include_req_body":{"default":false,"type":"boolean"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"include_resp_body_expr":{"items":{"type":"array"},"minItems":1,"type":"array"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"include_resp_body":{"default":false,"type":"boolean"},"severity":{"description":"base severity log level","enum":["ALERT","alert","CRIT","crit","ERR","err","DEBUG","debug","NOTICE","notice","INFO","info","EMEGR","emegr","WARNING","warning"],"default":"INFO","type":"string"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"customer_token":{"type":"string"}},"type":"object"},"metadata_schema":{"properties":{"host":{"default":"logs-01.loggly.com","type":"string"},"port":{"default":514,"type":"integer"},"log_format":{"type":"object"},"protocol":{"enum":["syslog","http","https"],"default":"syslog","type":"string"},"timeout":{"type":"integer","default":5000,"minimum":1}},"type":"object"}},"authz-casbin":{"schema":{"oneOf":[{"required":["model_path","policy_path","username"]},{"required":["model","policy","username"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"model_path":{"type":"string"},"policy_path":{"type":"string"},"model":{"type":"string"},"policy":{"type":"string"},"username":{"type":"string"},"disable":{"type":"boolean"}},"type":"object"},"version":0.1,"priority":2560,"metadata_schema":{"required":["model","policy"],"properties":{"model":{"type":"string"},"policy":{"type":"string"}},"type":"object"}},"limit-conn":{"version":0.1,"priority":1003,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["conn","burst","default_conn_delay","key"],"properties":{"allow_degradation":{"default":false,"type":"boolean"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"only_use_default_delay":{"default":false,"type":"boolean"},"disable":{"type":"boolean"},"key":{"type":"string"},"conn":{"exclusiveMinimum":0,"type":"integer"},"rejected_code":{"default":503,"type":"integer","maximum":599,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"burst":{"minimum":0,"type":"integer"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"}},"type":"object"}},"serverless-post-function":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["functions"],"properties":{"phase":{"enum":["rewrite","access","header_filter","body_filter","log","before_proxy"],"default":"access","type":"string"},"disable":{"type":"boolean"},"functions":{"type":"array","minItems":1,"items":{"type":"string"}}},"type":"object"},"version":0.1,"priority":-2000},"client-control":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"max_body_size":{"minimum":0,"type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"priority":22000,"version":0.1},"aws-lambda":{"version":0.1,"priority":-1899,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["function_uri"],"properties":{"keepalive_pool":{"type":"integer","default":5,"minimum":1},"disable":{"type":"boolean"},"authorization":{"properties":{"iam":{"required":["accesskey","secretkey"],"properties":{"accesskey":{"description":"access key id from from aws iam console","type":"string"},"aws_region":{"description":"the aws region that is receiving the request","default":"us-east-1","type":"string"},"secretkey":{"description":"secret access key from from aws iam console","type":"string"},"service":{"description":"the service that is receiving the request","default":"execute-api","type":"string"}},"type":"object"},"apikey":{"type":"string"}},"type":"object"},"ssl_verify":{"default":true,"type":"boolean"},"keepalive":{"default":true,"type":"boolean"},"function_uri":{"type":"string"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"timeout":{"type":"integer","default":3000,"minimum":100}},"type":"object"}},"ip-restriction":{"version":0.1,"priority":3000,"schema":{"oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"blacklist":{"type":"array","minItems":1,"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}]}},"disable":{"type":"boolean"},"message":{"default":"Your IP address is not allowed","minLength":1,"maxLength":1024,"type":"string"},"whitelist":{"type":"array","minItems":1,"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([12]?[0-9]|3[0-2])$","title":"IPv4\/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?\/[0-9]{1,3}$","title":"IPv6\/CIDR","type":"string"}]}}},"type":"object"}},"ua-restriction":{"version":0.1,"priority":2999,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"bypass_missing":{"default":false,"type":"boolean"},"disable":{"type":"boolean"},"allowlist":{"items":{"minLength":1,"type":"string"},"minItems":1,"type":"array"},"message":{"default":"Not allowed","minLength":1,"maxLength":1024,"type":"string"},"denylist":{"items":{"minLength":1,"type":"string"},"minItems":1,"type":"array"}},"type":"object"}},"proxy-cache":{"version":0.2,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"cache_http_status":{"default":[200,301,404],"type":"array","items":{"maximum":599,"minimum":200,"description":"http response status","type":"integer"},"minItems":1,"uniqueItems":true},"cache_ttl":{"type":"integer","default":300,"minimum":1},"cache_method":{"default":["GET","HEAD"],"type":"array","items":{"enum":["GET","POST","HEAD"],"description":"supported http method","type":"string"},"minItems":1,"uniqueItems":true},"hide_cache_headers":{"default":false,"type":"boolean"},"cache_control":{"default":false,"type":"boolean"},"cache_bypass":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"minItems":1,"type":"array"},"no_cache":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"minItems":1,"type":"array"},"cache_zone":{"default":"disk_cache_one","minLength":1,"maxLength":100,"type":"string"},"cache_strategy":{"enum":["disk","memory"],"default":"disk","type":"string"},"cache_key":{"default":["$host","$request_uri"],"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","description":"a key for caching","type":"string"},"minItems":1,"type":"array"},"disable":{"type":"boolean"}},"type":"object"},"priority":1009},"grpc-transcode":{"priority":506,"schema":{"additionalProperties":true,"$comment":"this is a mark for our injected plugin schema","required":["proto_id","service","method"],"properties":{"method":{"description":"the method name in the grpc service.","type":"string"},"deadline":{"default":0,"description":"deadline for grpc, millisecond","type":"number"},"disable":{"type":"boolean"},"pb_option":{"type":"array","minItems":1,"items":{"anyOf":[{"enum":["int64_as_number","int64_as_string","int64_as_hexstring"],"description":"enum as result","type":"string"},{"enum":["enum_as_name","enum_as_value"],"description":"int64 as result","type":"string"},{"enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"],"description":"default values option","type":"string"},{"enum":["enable_hooks","disable_hooks"],"description":"hooks option","type":"string"}],"type":"string"}},"proto_id":{"anyOf":[{"pattern":"^[a-zA-Z0-9-_.]+$","minLength":1,"maxLength":64,"type":"string"},{"minimum":1,"type":"integer"}]},"service":{"description":"the grpc service name","type":"string"}},"type":"object"},"version":0.1},"serverless-pre-function":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["functions"],"properties":{"phase":{"enum":["rewrite","access","header_filter","body_filter","log","before_proxy"],"default":"access","type":"string"},"disable":{"type":"boolean"},"functions":{"type":"array","minItems":1,"items":{"type":"string"}}},"type":"object"},"version":0.1,"priority":10000},"google-cloud-logging":{"version":0.1,"priority":407,"schema":{"oneOf":[{"required":["auth_config"]},{"required":["auth_file"]}],"$comment":"this is a mark for our injected plugin schema","properties":{"name":{"default":"google-cloud-logging","type":"string"},"ssl_verify":{"default":true,"type":"boolean"},"resource":{"default":{"type":"global"},"required":["type"],"properties":{"labels":{"type":"object"},"type":{"type":"string"}},"type":"object"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"auth_file":{"type":"string"},"log_id":{"default":"apisix.apache.org%2Flogs","type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"auth_config":{"required":["private_key","project_id","token_uri"],"properties":{"scopes":{"default":["https:\/\/www.googleapis.com\/auth\/logging.read","https:\/\/www.googleapis.com\/auth\/logging.write","https:\/\/www.googleapis.com\/auth\/logging.admin","https:\/\/www.googleapis.com\/auth\/cloud-platform"],"items":{"description":"Google OAuth2 Authorization Scopes","type":"string"},"type":"array","minItems":1,"uniqueItems":true},"private_key":{"type":"string"},"project_id":{"type":"string"},"token_uri":{"default":"https:\/\/oauth2.googleapis.com\/token","type":"string"},"entries_uri":{"default":"https:\/\/logging.googleapis.com\/v2\/entries:write","type":"string"}},"type":"object"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"disable":{"type":"boolean"}},"type":"object"}},"limit-count":{"version":0.4,"priority":1002,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"allow_degradation":{"default":false,"type":"boolean"},"policy":{"enum":["local","redis","redis-cluster"],"default":"local","type":"string"},"count":{"exclusiveMinimum":0,"type":"integer"},"time_window":{"exclusiveMinimum":0,"type":"integer"},"show_limit_quota_header":{"default":true,"type":"boolean"},"disable":{"type":"boolean"},"rejected_msg":{"minLength":1,"type":"string"},"rejected_code":{"default":503,"type":"integer","maximum":599,"minimum":200},"key":{"default":"remote_addr","type":"string"},"group":{"type":"string"},"key_type":{"enum":["var","var_combination","constant"],"default":"var","type":"string"}},"if":{"properties":{"policy":{"enum":["redis"]}}},"else":{"then":{"properties":{"redis_timeout":{"type":"integer","default":1000,"minimum":1},"redis_password":{"minLength":0,"type":"string"},"redis_cluster_nodes":{"items":{"minLength":2,"maxLength":100,"type":"string"},"minItems":2,"type":"array"},"redis_cluster_name":{"type":"string"}},"required":["redis_cluster_nodes","redis_cluster_name"]},"if":{"properties":{"policy":{"enum":["redis-cluster"]}}}},"required":["count","time_window"],"then":{"properties":{"redis_host":{"minLength":2,"type":"string"},"redis_port":{"type":"integer","default":6379,"minimum":1},"redis_password":{"minLength":0,"type":"string"},"redis_database":{"type":"integer","default":0,"minimum":0},"redis_timeout":{"type":"integer","default":1000,"minimum":1}},"required":["redis_host"]},"type":"object"}},"echo":{"version":0.1,"priority":412,"schema":{"properties":{"before_body":{"description":"body before the filter phase.","type":"string"},"headers":{"minProperties":1,"description":"new headers for response","type":"object"},"body":{"description":"body to replace upstream response.","type":"string"},"after_body":{"description":"body after the modification of filter phase.","type":"string"},"disable":{"type":"boolean"}},"anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"minProperties":1,"$comment":"this is a mark for our injected plugin schema","type":"object"}},"uri-blocker":{"schema":{"$comment":"this is a mark for our injected plugin schema","required":["block_rules"],"properties":{"block_rules":{"uniqueItems":true,"type":"array","items":{"minLength":1,"maxLength":4096,"type":"string"}},"case_insensitive":{"default":false,"type":"boolean"},"rejected_code":{"type":"integer","default":403,"minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"disable":{"type":"boolean"}},"type":"object"},"priority":2900,"version":0.1},"http-logger":{"version":0.1,"priority":410,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["uri"],"properties":{"name":{"default":"http logger","type":"string"},"disable":{"type":"boolean"},"ssl_verify":{"default":false,"type":"boolean"},"auth_header":{"default":"","type":"string"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"concat_method":{"enum":["json","new_line"],"default":"json","type":"string"},"timeout":{"type":"integer","default":3,"minimum":1},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"include_resp_body_expr":{"items":{"type":"array"},"minItems":1,"type":"array"},"uri":{"pattern":"^[^\\\/]+:\\\/\\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"include_resp_body":{"default":false,"type":"boolean"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"},"metadata_schema":{"properties":{"log_format":{"default":{"@timestamp":"$time_iso8601","host":"$host","client_ip":"$remote_addr"},"type":"object"}},"type":"object"}},"syslog":{"version":0.1,"priority":401,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"name":{"default":"http sys logger","type":"string"},"tls":{"default":false,"type":"boolean"},"max_retry_count":{"minimum":0,"default":0,"type":"integer"},"retry_delay":{"minimum":0,"default":1,"type":"integer"},"buffer_duration":{"minimum":1,"default":60,"type":"integer"},"inactive_timeout":{"minimum":1,"default":5,"type":"integer"},"host":{"type":"string"},"port":{"type":"integer"},"retry_interval":{"minimum":0,"type":"integer"},"flush_limit":{"type":"integer","default":4096,"minimum":1},"drop_limit":{"default":1048576,"type":"integer"},"timeout":{"type":"integer","default":3000,"minimum":1},"disable":{"type":"boolean"},"batch_max_size":{"minimum":1,"default":1000,"type":"integer"},"sock_type":{"enum":["tcp","udp"],"default":"tcp","type":"string"},"pool_size":{"type":"integer","default":5,"minimum":5},"max_retry_times":{"minimum":1,"type":"integer"},"include_req_body":{"default":false,"type":"boolean"}},"type":"object"}},"key-auth":{"version":0.1,"consumer_schema":{"required":["key"],"properties":{"key":{"type":"string"}},"type":"object"},"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"query":{"default":"apikey","type":"string"},"header":{"default":"apikey","type":"string"},"hide_credentials":{"default":false,"type":"boolean"},"disable":{"type":"boolean"}},"type":"object"},"priority":2500,"type":"auth"},"ext-plugin-post-req":{"version":0.1,"priority":-3000,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"conf":{"type":"array","minItems":1,"items":{"required":["name","value"],"properties":{"value":{"type":"string"},"name":{"minLength":1,"maxLength":128,"type":"string"}},"type":"object"}},"allow_degradation":{"default":false,"type":"boolean"},"disable":{"type":"boolean"}},"type":"object"}},"basic-auth":{"version":0.1,"consumer_schema":{"properties":{"username":{"type":"string"},"password":{"type":"string"}},"required":["username","password"],"title":"work with consumer object","type":"object"},"schema":{"properties":{"hide_credentials":{"default":false,"type":"boolean"},"disable":{"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","title":"work with route or service object","type":"object"},"priority":2520,"type":"auth"},"forward-auth":{"version":0.1,"priority":2002,"schema":{"$comment":"this is a mark for our injected plugin schema","required":["uri"],"properties":{"keepalive_pool":{"type":"integer","default":5,"minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"upstream_headers":{"description":"authorization response header that will be sent to the upstream","items":{"type":"string"},"default":{},"type":"array"},"client_headers":{"description":"authorization response header that will be sent tothe client when authorizing failed","items":{"type":"string"},"default":{},"type":"array"},"timeout":{"description":"timeout in milliseconds","minimum":1,"maximum":60000,"default":3000,"type":"integer"},"uri":{"type":"string"},"disable":{"type":"boolean"},"request_method":{"description":"the method for client to request the authorization service","enum":["GET","POST"],"default":"GET","type":"string"},"request_headers":{"description":"client request header that will be sent to the authorization service","items":{"type":"string"},"default":{},"type":"array"},"keepalive_timeout":{"type":"integer","default":60000,"minimum":1000},"keepalive":{"default":true,"type":"boolean"}},"type":"object"}}}}
